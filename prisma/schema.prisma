generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Brand {
  id          String    @id @default(cuid())
  name        String    @unique
  description String?
  websiteUrl  String?
  logoUrl     String?
  products    Product[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Product {
  id                String   @id @default(cuid())
  name              String
  brandId           String
  brand             Brand    @relation(fields: [brandId], references: [id], onDelete: Cascade)
  size              Int
  price             Float
  images            String[]
  concentration     String
  gender            String
  description       String   @db.Text
  discountAmount    Float    @default(0)
  isFeatured        Boolean  @default(false)
  isBestSeller      Boolean  @default(false)
  stock             Int      @default(0)
  fragranceProfiles String[] // NEW: Array of profiles like ["Fresh", "Woody", "Citrus"]
  topNotes          String[]
  heartNotes        String[]
  baseNotes         String[]
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([brandId])
  @@index([isFeatured])
  @@index([isBestSeller])
}

model Order {
  id              String   @id @default(cuid())
  orderNumber     String   @unique
  
  // Customer Info
  customerName    String
  customerEmail   String
  customerPhone   String?
  
  // Shipping Address
  shippingAddress String
  shippingCity    String
  shippingZip     String
  shippingCountry String
  
  // Order Details
  items           Json     // Store cart items as JSON
  subtotal        Float
  shippingCost    Float    @default(0)
  total           Float
  
  // Payment Info
  stripeSessionId String?  @unique
  stripePaymentId String?
  paymentStatus   String   @default("pending") // pending, paid, failed, refunded
  
  // Order Status
  orderStatus     String   @default("processing") // processing, shipped, delivered, cancelled
  
  // Tracking
  trackingNumber  String?
  
  // Timestamps
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  paidAt          DateTime?
  shippedAt       DateTime?
  deliveredAt     DateTime?
  
  @@index([customerEmail])
  @@index([orderNumber])
  @@index([paymentStatus])
  @@index([orderStatus])
}